<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Protocol X | Ù„Ø¹Ø¨Ø© Ø§Ù„Ø£Ù„ØºØ§Ø² Ø§Ù„ØªØ­Ø¯ÙŠ - Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„Ø³Ø±ÙŠØ©</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            margin: 0;
            background: #0a0a14;
            color: #00ffcc;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            overflow-x: hidden;
            min-height: 100vh;
        }
        
        canvas {
            position: fixed;
            top: 0;
            left: 0;
            z-index: -1;
        }
        
        /* Ø´Ø§Ø´Ø© Ø§Ù„Ø¯Ø®ÙˆÙ„ */
        .login-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(5, 10, 20, 0.98);
            z-index: 1000;
            display: flex;
            justify-content: center;
            align-items: center;
            backdrop-filter: blur(15px);
        }
        
        .login-container {
            background: rgba(10, 25, 40, 0.95);
            padding: 60px 40px;
            border-radius: 25px;
            box-shadow: 0 0 50px rgba(0, 255, 204, 0.5);
            text-align: center;
            max-width: 500px;
            width: 90%;
            border: 2px solid #00ffcc;
            animation: fadeIn 1s;
        }
        
        .login-container h1 {
            margin-bottom: 20px;
            color: #00ffcc;
            font-size: 2.5rem;
            text-shadow: 0 0 15px rgba(0, 255, 204, 0.7);
        }
        
        .login-container p {
            margin-bottom: 30px;
            color: #aaffee;
            font-size: 1.1rem;
            line-height: 1.6;
        }
        
        .difficulty-select {
            margin: 20px 0;
            text-align: right;
        }
        
        .difficulty-select label {
            display: block;
            margin-bottom: 10px;
            color: #66ffd9;
        }
        
        #difficulty {
            width: 100%;
            padding: 12px;
            background: rgba(0, 0, 0, 0.6);
            border: 2px solid #00ffcc;
            border-radius: 10px;
            color: #00ffcc;
            font-size: 1.1rem;
            direction: rtl;
        }
        
        .password-input {
            position: relative;
            margin: 30px 0;
        }
        
        #password {
            width: 100%;
            padding: 18px 20px;
            background: rgba(0, 0, 0, 0.6);
            border: 2px solid #00ffcc;
            border-radius: 15px;
            color: #00ffcc;
            font-size: 1.2rem;
            text-align: center;
            letter-spacing: 3px;
            direction: ltr;
            transition: all 0.3s;
        }
        
        #password:focus {
            outline: none;
            box-shadow: 0 0 25px rgba(0, 255, 204, 0.7);
            border-color: #66ffd9;
        }
        
        .password-hint {
            color: #66ccff;
            font-size: 0.9rem;
            margin-top: 10px;
            font-style: italic;
        }
        
        .error-message {
            color: #ff6666;
            margin-top: 15px;
            min-height: 25px;
            font-weight: bold;
            text-shadow: 0 0 10px rgba(255, 0, 0, 0.5);
        }
        
        .login-btn {
            background: linear-gradient(135deg, #00ffcc, #00997a);
            color: #001a14;
            border: none;
            padding: 15px 40px;
            font-size: 1.2rem;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: bold;
            margin-top: 20px;
            width: 100%;
        }
        
        .login-btn:hover {
            background: linear-gradient(135deg, #00ffaa, #008066);
            transform: scale(1.05);
            box-shadow: 0 0 20px rgba(0, 255, 204, 0.7);
        }
        
        /* ØªØµÙ…ÙŠÙ… Ø§Ù„Ù‡ÙŠØ¯Ø± */
        .header {
            background: rgba(0, 20, 20, 0.85);
            padding: 15px 20px;
            border-bottom: 2px solid #00ffcc;
            box-shadow: 0 0 20px rgba(0, 255, 204, 0.3);
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: relative;
            backdrop-filter: blur(5px);
        }
        
        .logo {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 1.8rem;
            font-weight: bold;
            text-shadow: 0 0 10px #00ffcc;
        }
        
        .logo i {
            color: #00ffcc;
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }
        
        .stats-container {
            display: flex;
            gap: 25px;
            font-size: 1.1rem;
        }
        
        .stat {
            display: flex;
            align-items: center;
            gap: 8px;
            background: rgba(0, 255, 204, 0.1);
            padding: 8px 15px;
            border-radius: 8px;
            border: 1px solid rgba(0, 255, 204, 0.3);
        }
        
        .stat i {
            color: #00ffcc;
        }
        
        .difficulty-badge {
            background: rgba(255, 100, 0, 0.3);
            padding: 5px 10px;
            border-radius: 5px;
            font-size: 0.9rem;
            border: 1px solid #ff6600;
        }
        
        /* ØªØµÙ…ÙŠÙ… Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ */
        .container {
            max-width: 900px;
            margin: 40px auto;
            padding: 0 20px;
            text-align: center;
        }
        
        .progress-container {
            margin: 30px 0;
            background: rgba(0, 255, 204, 0.1);
            border-radius: 15px;
            padding: 20px;
            border: 1px solid rgba(0, 255, 204, 0.2);
        }
        
        .progress-bar {
            height: 12px;
            background: rgba(0, 255, 204, 0.2);
            border-radius: 6px;
            overflow: hidden;
            margin-top: 10px;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #00ffcc, #00b386);
            border-radius: 6px;
            width: 2%;
            transition: width 0.8s cubic-bezier(0.22, 0.61, 0.36, 1);
        }
        
        /* ØªØµÙ…ÙŠÙ… ØµÙ†Ø¯ÙˆÙ‚ Ø§Ù„Ù„ØºØ² */
        #box {
            background: rgba(5, 15, 25, 0.85);
            padding: 40px;
            border-radius: 20px;
            box-shadow: 0 0 30px rgba(0, 255, 204, 0.4);
            margin: 30px auto;
            width: 100%;
            max-width: 700px;
            transition: transform 0.5s, opacity 0.5s;
            border: 1px solid rgba(0, 255, 204, 0.2);
            backdrop-filter: blur(10px);
        }
        
        #box:hover {
            transform: translateY(-5px);
            box-shadow: 0 0 40px rgba(0, 255, 204, 0.5);
        }
        
        .stage-info {
            display: flex;
            justify-content: space-between;
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 1px solid rgba(0, 255, 204, 0.2);
        }
        
        #stageTitle {
            font-size: 1.8rem;
            color: #00ffcc;
            text-shadow: 0 0 8px rgba(0, 255, 204, 0.5);
        }
        
        .stage-hint {
            color: #66ffd9;
            font-size: 0.9rem;
            display: flex;
            align-items: center;
            gap: 5px;
        }
        
        #question {
            font-size: 1.5rem;
            margin: 25px 0;
            line-height: 1.6;
            min-height: 80px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .input-container {
            margin: 30px 0;
            position: relative;
        }
        
        #answer {
            padding: 15px 20px;
            width: 100%;
            background: rgba(0, 0, 0, 0.5);
            color: #00ffcc;
            border: 2px solid #00ffcc;
            border-radius: 10px;
            font-size: 1.2rem;
            transition: all 0.3s;
            direction: ltr;
            text-align: center;
        }
        
        #answer:focus {
            outline: none;
            box-shadow: 0 0 15px rgba(0, 255, 204, 0.5);
            border-color: #66ffd9;
            background: rgba(0, 10, 10, 0.7);
        }
        
        .buttons {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 25px;
        }
        
        button {
            padding: 12px 30px;
            font-size: 1.1rem;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 10px;
            font-weight: bold;
        }
        
        #checkBtn {
            background: linear-gradient(135deg, #00ffcc, #00997a);
            color: #001a14;
        }
        
        #checkBtn:hover {
            background: linear-gradient(135deg, #00ffaa, #008066);
            transform: scale(1.05);
            box-shadow: 0 0 15px rgba(0, 255, 204, 0.7);
        }
        
        #hintBtn {
            background: rgba(0, 150, 255, 0.2);
            color: #66ccff;
            border: 1px solid #0099ff;
        }
        
        #hintBtn:hover {
            background: rgba(0, 150, 255, 0.4);
            transform: scale(1.05);
        }
        
        /* ØªØ£Ø«ÙŠØ±Ø§Øª Ø§Ù„Ø±Ø³ÙˆÙ…ÙŠØ§Øª */
        .particle {
            position: absolute;
            width: 4px;
            height: 4px;
            background-color: #00ffcc;
            border-radius: 50%;
            pointer-events: none;
            z-index: -1;
        }
        
        /* Ø´Ø§Ø´Ø© Ø§Ù„Ù‚ØµØ© */
        .story-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(5, 10, 30, 0.95);
            z-index: 2000;
            display: none;
            justify-content: center;
            align-items: center;
            backdrop-filter: blur(15px);
        }
        
        .story-content {
            background: rgba(15, 25, 45, 0.95);
            padding: 40px;
            border-radius: 20px;
            max-width: 700px;
            width: 90%;
            border: 2px solid #0066ff;
            box-shadow: 0 0 40px rgba(0, 100, 255, 0.5);
            text-align: center;
            animation: slideIn 0.8s;
        }
        
        @keyframes slideIn {
            from { opacity: 0; transform: translateY(-30px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .story-content h2 {
            color: #0066ff;
            margin-bottom: 20px;
            font-size: 2rem;
            text-shadow: 0 0 10px rgba(0, 100, 255, 0.7);
        }
        
        .story-content p {
            color: #aaccff;
            font-size: 1.2rem;
            line-height: 1.8;
            margin-bottom: 30px;
            text-align: justify;
        }
        
        .story-content .highlight {
            color: #00ffcc;
            font-weight: bold;
        }
        
        .continue-btn {
            background: linear-gradient(135deg, #0066ff, #003399);
            color: white;
            padding: 15px 40px;
            font-size: 1.2rem;
            border-radius: 10px;
            border: none;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .continue-btn:hover {
            background: linear-gradient(135deg, #0088ff, #0044cc);
            transform: scale(1.05);
            box-shadow: 0 0 20px rgba(0, 100, 255, 0.7);
        }
        
        /* ØªØµÙ…ÙŠÙ… Ø§Ù„ÙÙˆØªØ± */
        footer {
            position: fixed;
            bottom: 0;
            width: 100%;
            text-align: center;
            padding: 15px;
            background: rgba(0, 20, 20, 0.9);
            border-top: 1px solid #00ffcc;
            font-size: 1rem;
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 10px;
        }
        
        .social-icons {
            display: flex;
            gap: 15px;
            margin-left: 20px;
        }
        
        .social-icons a {
            color: #66ffd9;
            font-size: 1.2rem;
            transition: all 0.3s;
        }
        
        .social-icons a:hover {
            color: #00ffcc;
            transform: translateY(-3px);
        }
        
        /* ØªØµÙ…ÙŠÙ… Ø´Ø§Ø´Ø© Ø§Ù„Ù†Ù‡Ø§ÙŠØ© */
        .end-screen {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(5, 10, 20, 0.95);
            z-index: 1000;
            justify-content: center;
            align-items: center;
            backdrop-filter: blur(10px);
        }
        
        .end-content {
            background: rgba(10, 25, 40, 0.95);
            padding: 50px;
            border-radius: 25px;
            box-shadow: 0 0 50px rgba(0, 255, 204, 0.5);
            text-align: center;
            max-width: 600px;
            width: 90%;
            border: 2px solid #00ffcc;
            animation: fadeIn 0.8s;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: scale(0.9); }
            to { opacity: 1; transform: scale(1); }
        }
        
        .win-code {
            background: rgba(0, 255, 204, 0.1);
            padding: 15px;
            border-radius: 10px;
            margin: 20px 0;
            font-family: 'Courier New', monospace;
            font-size: 1.3rem;
            letter-spacing: 3px;
            border: 1px dashed #00ffcc;
        }
        
        .restart-btn {
            background: linear-gradient(135deg, #ff6600, #cc5200);
            color: white;
            margin-top: 20px;
        }
        
        .restart-btn:hover {
            background: linear-gradient(135deg, #ff8533, #e65c00);
        }
        
        /* Ù„ÙˆØ­Ø© Ø§Ù„Ù…ØªØµØ¯Ø±ÙŠÙ† */
        .leaderboard-btn {
            position: fixed;
            top: 20px;
            left: 20px;
            background: rgba(255, 204, 0, 0.2);
            color: #ffcc00;
            border: 1px solid #ffcc00;
            padding: 10px 20px;
            border-radius: 8px;
            cursor: pointer;
            z-index: 100;
            font-weight: bold;
        }
        
        .leaderboard-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
            z-index: 2000;
            display: none;
            justify-content: center;
            align-items: center;
        }
        
        .leaderboard-content {
            background: rgba(20, 30, 50, 0.95);
            padding: 40px;
            border-radius: 20px;
            width: 90%;
            max-width: 600px;
            border: 2px solid #ffcc00;
        }
        
        .leaderboard-content h2 {
            color: #ffcc00;
            text-align: center;
            margin-bottom: 30px;
            font-size: 2rem;
        }
        
        .leaderboard-table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }
        
        .leaderboard-table th {
            background: rgba(255, 204, 0, 0.2);
            color: #ffcc00;
            padding: 15px;
            text-align: center;
            border-bottom: 2px solid #ffcc00;
        }
        
        .leaderboard-table td {
            padding: 12px;
            text-align: center;
            border-bottom: 1px solid rgba(255, 204, 0, 0.3);
            color: #ffffff;
        }
        
        .leaderboard-table tr:nth-child(1) td {
            background: rgba(255, 215, 0, 0.2);
            color: #ffd700;
            font-weight: bold;
        }
        
        /* ØªØ£Ø«ÙŠØ±Ø§Øª Ø§Ù„Ø­Ø±ÙƒØ© */
        .fade-out {
            opacity: 0;
            transform: translateY(-20px);
        }
        
        .fade-in {
            opacity: 1;
            transform: translateY(0);
        }
        
        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            10%, 30%, 50%, 70%, 90% { transform: translateX(-10px); }
            20%, 40%, 60%, 80% { transform: translateX(10px); }
        }
        
        /* ØªØµÙ…ÙŠÙ… Ù…ØªØ¬Ø§ÙˆØ¨ */
        @media (max-width: 768px) {
            .header {
                flex-direction: column;
                gap: 15px;
                padding: 15px;
            }
            
            .stats-container {
                width: 100%;
                justify-content: space-between;
            }
            
            .container {
                margin: 20px auto;
                padding: 0 15px;
            }
            
            #box {
                padding: 25px;
            }
            
            .buttons {
                flex-direction: column;
                gap: 15px;
            }
            
            button {
                width: 100%;
                justify-content: center;
            }
            
            #question {
                font-size: 1.3rem;
            }
            
            .login-container {
                padding: 40px 25px;
            }
            
            .leaderboard-btn {
                position: relative;
                top: 0;
                left: 0;
                margin: 10px auto;
                display: block;
                width: fit-content;
            }
        }
        
        /* Ø´Ø§Ø±Ø© Ø§Ù„Ù…Ø±Ø­Ù„Ø© Ø§Ù„Ø³Ø±ÙŠØ© */
        .secret-badge {
            background: linear-gradient(135deg, #ff00ff, #cc00cc);
            color: white;
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 0.9rem;
            margin-left: 10px;
            animation: glow 1.5s infinite alternate;
        }
        
        @keyframes glow {
            from { box-shadow: 0 0 5px #ff00ff; }
            to { box-shadow: 0 0 15px #ff00ff, 0 0 20px #ff00ff; }
        }
    </style>
</head>
<body>
    <canvas id="matrix"></canvas>
    
    <!-- Ø´Ø§Ø´Ø© Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø¨ÙƒÙ„Ù…Ø© Ø§Ù„Ø³Ø± -->
    <div class="login-screen" id="loginScreen">
        <div class="login-container">
            <h1><i class="fas fa-user-secret"></i> Protocol X</h1>
            <p>Ù„Ø¹Ø¨Ø© Ø§Ù„Ø£Ù„ØºØ§Ø² Ø§Ù„Ø³Ø±ÙŠØ© - Ø´Ø±Ø·Ø© Ø§Ù„Ø£Ù†Ø¨Ùˆ </p>
            <p style="color: #ffcc00; font-size: 0.9rem;">âš  Ù‡Ø°Ù‡ Ø§Ù„Ù†Ø³Ø®Ø© ØªØªØ·Ù„Ø¨ ÙƒÙ„Ù…Ø© Ø³Ø± Ø®Ø§ØµØ© Ù„Ù„ÙˆØµÙˆÙ„</p>
            
            <div class="difficulty-select">
                <label for="difficulty"><i class="fas fa-chart-line"></i> Ø§Ø®ØªØ± Ù…Ø³ØªÙˆÙ‰ Ø§Ù„ØµØ¹ÙˆØ¨Ø©:</label>
                <select id="difficulty">
                    <option value="easy">Ø³Ù‡Ù„ (ØªÙ„Ù…ÙŠØ­Ø§Øª ØºÙŠØ± Ù…Ø­Ø¯ÙˆØ¯Ø©)</option>
                    <option value="medium" selected>Ù…ØªÙˆØ³Ø· (3 ØªÙ„Ù…ÙŠØ­Ø§Øª)</option>
                    <option value="hard">ØµØ¹Ø¨ (Ø¨Ø¯ÙˆÙ† ØªÙ„Ù…ÙŠØ­Ø§Øª)</option>
                </select>
            </div>
            
            <div class="password-input">
                <input type="password" id="password" placeholder="Ø£Ø¯Ø®Ù„ ÙƒÙ„Ù…Ø© Ø§Ù„Ø³Ø± Ù„Ù„Ø¯Ø®ÙˆÙ„" autocomplete="off">
                <div class="password-hint">ÙƒÙ„Ù…Ø© Ø§Ù„Ø³Ø± Ù…ÙƒÙˆÙ†Ø© Ù…Ù† 6 Ø£Ø­Ø±Ù (Ø£Ø­Ø±Ù ØµØºÙŠØ±Ø©)</div>
            </div>
            
            <div class="error-message" id="errorMsg"></div>
            
            <button class="login-btn" onclick="checkPassword()">
                <i class="fas fa-unlock"></i> ÙØªØ­ Ø§Ù„Ù„Ø¹Ø¨Ø©
            </button>
            
            <div style="margin-top: 30px; color: #66ccff; font-size: 0.85rem;">
                <i class="fas fa-info-circle"></i> ØªØ­ØªÙˆÙŠ Ù‡Ø°Ù‡ Ø§Ù„Ù†Ø³Ø®Ø© Ø¹Ù„Ù‰ 50 Ù„ØºØ²Ù‹Ø§ ØªØ­Ø¯ÙŠÙ‹Ø§ + Ù…Ø±Ø§Ø­Ù„ Ø³Ø±ÙŠØ©
            </div>
        </div>
    </div>
    
    <!-- Ø´Ø§Ø´Ø© Ø§Ù„Ù‚ØµØ© -->
    <div class="story-screen" id="storyScreen">
        <div class="story-content">
            <h2 id="storyTitle">Ø§Ù„Ø¨Ø±ÙˆØªÙˆÙƒÙˆÙ„ Ø§Ù„Ø³Ø±ÙŠ X</h2>
            <p id="storyText">
                Ø£Ù†Øª <span class="highlight">Ø¶Ø§Ø¨Ø· Ù…Ø¨Ø§Ø­Ø« Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠØ©</span> ÙÙŠ ÙˆØ­Ø¯Ø© Ø§Ù„Ø¬Ø±Ø§Ø¦Ù… Ø§Ù„Ø³ÙŠØ¨Ø±Ø§Ù†ÙŠØ© Ø§Ù„Ù…ØªÙ‚Ø¯Ù…Ø©.<br><br>
                Ù…Ù‡Ù…ØªÙƒ: Ø§Ø®ØªØ±Ø§Ù‚ <span class="highlight">Ø´Ø¨ÙƒØ© "Ù…Ø§ØªØ±ÙŠÙƒØ³"</span> Ø§Ù„Ø¥Ø¬Ø±Ø§Ù…ÙŠØ© Ø§Ù„ØªÙŠ ØªØªØ­ÙƒÙ… ÙÙŠ Ù…Ø¯ÙŠÙ†Ø© Ù†ÙŠÙˆÙ…ÙˆØ¨ÙˆÙ„ÙŠØ³.<br><br>
                Ø§Ù„Ù…Ø¯ÙŠØ± Ø£Ø¹Ø·Ø§Ùƒ 50 Ø¨Ø±ÙˆØªÙˆÙƒÙˆÙ„Ù‹Ø§ Ø£Ù…Ù†ÙŠÙ‹Ø§ ÙŠØ¬Ø¨ Ø§Ø®ØªØ±Ø§Ù‚Ù‡Ø§ Ù„Ù„ÙˆØµÙˆÙ„ Ø¥Ù„Ù‰ <span class="highlight">Ø§Ù„Ø®Ø§Ø¯Ù… Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ</span>.<br><br>
                Ø§Ø³ØªØ®Ø¯Ù… Ù…Ù‡Ø§Ø±Ø§ØªÙƒ ÙÙŠ Ø§Ù„Ø±ÙŠØ§Ø¶ÙŠØ§Øª ÙˆØ§Ù„ØªØ´ÙÙŠØ± ÙˆØ­Ù„ Ø§Ù„Ø£Ù„ØºØ§Ø² Ù„ØªØ®Ø·ÙŠ ÙƒÙ„ Ø­Ø§Ø¬Ø².<br><br>
                <span style="color:#ff3333">âš  ØªØ­Ø°ÙŠØ±:</span> Ø¥Ø°Ø§ ÙØ´Ù„Øª 3 Ù…Ø±Ø§ØªØŒ Ø³ÙŠÙ†ÙƒØ´Ù Ù…ÙˆÙ‚Ø¹Ùƒ ÙˆØ³ÙŠØªÙ… Ø§Ù„Ù‚Ø¨Ø¶ Ø¹Ù„ÙŠÙƒ!
            </p>
            <button class="continue-btn" onclick="closeStory()">
                <i class="fas fa-play"></i> Ø¨Ø¯Ø¡ Ø§Ù„Ù…Ù‡Ù…Ø©
            </button>
        </div>
    </div>
    
    <!-- Ø²Ø± Ù„ÙˆØ­Ø© Ø§Ù„Ù…ØªØµØ¯Ø±ÙŠÙ† -->
    <button class="leaderboard-btn" onclick="showLeaderboard()" id="leaderboardBtn" style="display:none;">
        <i class="fas fa-trophy"></i> Ø§Ù„Ù…ØªØµØ¯Ø±ÙŠÙ†
    </button>
    
    <!-- Ø§Ù„Ù‡ÙŠØ¯Ø± Ø§Ù„Ù…Ø­Ø³Ù† -->
    <div class="header" style="display: none;" id="gameHeader">
        <div class="logo">
            <i class="fas fa-user-secret"></i>
            <span>Protocol X</span>
            <div class="difficulty-badge" id="difficultyBadge">Ù…ØªÙˆØ³Ø·</div>
        </div>
        <div class="stats-container">
            <div class="stat">
                <i class="fas fa-clock"></i>
                <span>Ø§Ù„ÙˆÙ‚Øª: <span id="timer">0</span> Ø«Ø§Ù†ÙŠØ©</span>
            </div>
            <div class="stat">
                <i class="fas fa-star"></i>
                <span>Ø§Ù„Ù†Ù‚Ø§Ø·: <span id="score">0</span></span>
            </div>
            <div class="stat">
                <i class="fas fa-layer-group"></i>
                <span>Ø§Ù„Ù…Ø±Ø­Ù„Ø©: <span id="stageNum">1</span>/50</span>
            </div>
        </div>
    </div>
    
    <!-- Ø´Ø±ÙŠØ· Ø§Ù„ØªÙ‚Ø¯Ù… -->
    <div class="container" style="display: none;" id="gameContainer">
        <div class="progress-container">
            <div>ØªÙ‚Ø¯Ù… Ø§Ù„Ù…Ù‡Ù…Ø©</div>
            <div class="progress-bar">
                <div class="progress-fill" id="progressFill"></div>
            </div>
        </div>
        
        <!-- ØµÙ†Ø¯ÙˆÙ‚ Ø§Ù„Ù„ØºØ² -->
        <div id="box" class="fade-in">
            <div class="stage-info">
                <h2 id="stageTitle">Ø§Ù„Ù…Ø±Ø­Ù„Ø© 1</h2>
                <div class="stage-hint">
                    <i class="fas fa-lightbulb"></i>
                    <span id="hintText">Ø§ÙƒØªØ¨ Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø© ÙÙŠ Ø§Ù„Ø­Ù‚Ù„ Ø£Ø¯Ù†Ø§Ù‡</span>
                </div>
            </div>
            <p id="question">Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù„ØºØ²...</p>
            <div class="input-container">
                <input type="text" id="answer" placeholder="Ø§ÙƒØªØ¨ Ø§Ù„Ø­Ù„ Ù‡Ù†Ø§ Ø«Ù… Ø§Ø¶ØºØ· Enter" autocomplete="off">
            </div>
            <div class="buttons">
                <button id="checkBtn" onclick="checkAnswer()">
                    <i class="fas fa-check-circle"></i> ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø©
                </button>
                <button id="hintBtn" onclick="showHint()">
                    <i class="fas fa-question-circle"></i> Ù…Ø³Ø§Ø¹Ø¯Ø© (<span id="hintCounter">3</span>/3)
                </button>
            </div>
        </div>
    </div>
    
    <!-- Ø´Ø§Ø´Ø© Ø§Ù„Ù†Ù‡Ø§ÙŠØ© -->
    <div class="end-screen" id="endScreen">
        <div class="end-content">
            <h1><i class="fas fa-trophy"></i> Ù…Ù‡Ù…Ø© Ù…ÙƒØªÙ…Ù„Ø©!</h1>
            <p>Ù„Ù‚Ø¯ Ù†Ø¬Ø­Øª ÙÙŠ Ø§Ø®ØªØ±Ø§Ù‚ Ø¬Ù…ÙŠØ¹ Ø¨Ø±ÙˆØªÙˆÙƒÙˆÙ„Ø§Øª Ø§Ù„Ø£Ù…Ø§Ù†!</p>
            
            <div style="margin: 30px 0;">
                <h3><i class="fas fa-star"></i> Ø§Ù„Ù†Ù‚Ø§Ø· Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠØ©: <span id="finalScore">0</span></h3>
                <h3><i class="fas fa-clock"></i> Ø§Ù„ÙˆÙ‚Øª Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ: <span id="finalTime">0</span> Ø«Ø§Ù†ÙŠØ©</h3>
                <h3><i class="fas fa-bolt"></i> Ù…Ø³ØªÙˆÙ‰ Ø§Ù„ØµØ¹ÙˆØ¨Ø©: <span id="finalDifficulty">Ù…ØªÙˆØ³Ø·</span></h3>
                <h3><i class="fas fa-brain"></i> Ù†Ø³Ø¨Ø© Ø§Ù„Ù†Ø¬Ø§Ø­: <span id="successRate">0</span>%</h3>
            </div>
            
            <div class="win-code">
                <div>ÙƒÙˆØ¯ Ø§Ù„ØªØ­Ù‚Ù‚ Ø§Ù„Ø®Ø§Øµ Ø¨Ø§Ù„Ù…Ù‡Ù…Ø©:</div>
                <div style="font-weight: bold; color: #00ffcc; font-size: 1.5rem;">POLICE-HACKER-ELITE</div>
            </div>
            
            <button class="restart-btn" onclick="restartGame()">
                <i class="fas fa-redo"></i> Ù…Ù‡Ù…Ø© Ø¬Ø¯ÙŠØ¯Ø©
            </button>
            <button class="login-btn" onclick="showLeaderboard()" style="margin-top: 10px;">
                <i class="fas fa-trophy"></i> Ø¹Ø±Ø¶ Ù„ÙˆØ­Ø© Ø§Ù„Ù…ØªØµØ¯Ø±ÙŠÙ†
            </button>
        </div>
    </div>
    
    <!-- Ù„ÙˆØ­Ø© Ø§Ù„Ù…ØªØµØ¯Ø±ÙŠÙ† -->
    <div class="leaderboard-screen" id="leaderboardScreen">
        <div class="leaderboard-content">
            <h2><i class="fas fa-trophy"></i> Ø£ÙØ¶Ù„ 10 Ù…Ø­Ù‚Ù‚ÙŠÙ†</h2>
            <table class="leaderboard-table">
                <thead>
                    <tr>
                        <th>#</th>
                        <th>Ø§Ø³Ù… Ø§Ù„Ù…Ø­Ù‚Ù‚</th>
                        <th>Ø§Ù„Ù†Ù‚Ø§Ø·</th>
                        <th>Ø§Ù„ÙˆÙ‚Øª</th>
                        <th>Ø§Ù„Ù…Ø³ØªÙˆÙ‰</th>
                    </tr>
                </thead>
                <tbody id="leaderboardBody">
                    <!-- Ø³ÙŠØªÙ… ØªØ¹Ø¨Ø¦ØªÙ‡ Ø¨Ø§Ù„Ø¬Ø§ÙØ§Ø³ÙƒØ±ÙŠØ¨Øª -->
                </tbody>
            </table>
            <div style="margin-top: 20px; text-align: center;">
                <button class="continue-btn" onclick="closeLeaderboard()">
                    <i class="fas fa-times"></i> Ø¥ØºÙ„Ø§Ù‚
                </button>
                <button class="login-btn" onclick="clearLeaderboard()" style="margin-left: 10px; background: linear-gradient(135deg, #ff3333, #cc0000);">
                    <i class="fas fa-trash"></i> Ù…Ø³Ø­ Ø§Ù„Ø³Ø¬Ù„Ø§Øª
                </button>
            </div>
        </div>
    </div>
    
    <!-- Ø§Ù„ÙÙˆØªØ± -->
    <footer id="gameFooter" style="display: none;">
        <span>ÙˆØ­Ø¯Ø© Ø§Ù„Ø¬Ø±Ø§Ø¦Ù… Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠØ© | Ø¨ÙˆØ§Ø³Ø·Ø© Ø§Ø³Ù„Ø§Ù…</span>
        <div class="social-icons">
            <a href="#" title="Ø§Ù„Ø¥Ø¨Ù„Ø§Øº Ø¹Ù† Ø«ØºØ±Ø©"><i class="fas fa-shield-alt"></i></a>
            <a href="#" title="Ù…Ø±ÙƒØ² Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯Ø©"><i class="fas fa-headset"></i></a>
            <a href="#" title="Ø§Ù„ØªÙˆØ§ØµÙ„ Ù…Ø¹ Ø§Ù„Ù‚Ø³Ù…"><i class="fas fa-phone-alt"></i></a>
        </div>
    </footer>

    <script>
        // === Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ù„Ø¹Ø¨Ø© ===
        const SECRET_PASSWORD = "ISLAM_X";
        let currentStage = 0;
        let score = 0;
        let totalTime = 0;
        let stageTime = 0;
        let gameActive = false;
        let hintsUsed = 0;
        let totalHints = 3;
        let correctAnswers = 0;
        let selectedDifficulty = "medium";
        let secretStageUnlocked = false;
        let fastAnswersCount = 0;
        let playerName = "Ø§Ù„Ù…Ø­Ù‚Ù‚";
        
        // === Ù…ØµÙÙˆÙØ© Ø§Ù„Ø£Ù„ØºØ§Ø² (50 Ù„ØºØ²) ===
        const riddles = [
            // Ø§Ù„Ù…Ø³ØªÙˆÙ‰ 1-10: Ø£Ù„ØºØ§Ø² Ø³Ù‡Ù„Ø©
            {q:"5 Ã— 6 ØŸ", a:"30", hint:"Ø­Ø§ØµÙ„ Ø¶Ø±Ø¨ 5 ÙÙŠ 6"},
            {q:"100 Ã· 4 ØŸ", a:"25", hint:"Ù‚Ø³Ù…Ø© 100 Ø¹Ù„Ù‰ 4"},
            {q:"7 + 8 ØŸ", a:"15", hint:"Ù…Ø¬Ù…ÙˆØ¹ 7 Ùˆ 8"},
            {q:"Ù…Ø±Ø¨Ø¹ 9 ØŸ", a:"81", hint:"9 Ã— 9"},
            {q:"12 Ã— 2 ØŸ", a:"24", hint:"12 Ù…Ø¶Ø±ÙˆØ¨ ÙÙŠ 2"},
            {q:"Ù†ØµÙ 50 ØŸ", a:"25", hint:"50 Ù…Ù‚Ø³ÙˆÙ… Ø¹Ù„Ù‰ 2"},
            {q:"8 Ã— 8 ØŸ", a:"64", hint:"8 ÙÙŠ 8"},
            {q:"20 Ã· 5 ØŸ", a:"4", hint:"20 Ù…Ù‚Ø³ÙˆÙ… Ø¹Ù„Ù‰ 5"},
            {q:"3 Ã— 9 ØŸ", a:"27", hint:"3 Ù…Ø¶Ø±ÙˆØ¨ ÙÙŠ 9"},
            {q:"15 + 17 ØŸ", a:"32", hint:"Ù…Ø¬Ù…ÙˆØ¹ 15 Ùˆ 17"},
            
            // Ø§Ù„Ù…Ø³ØªÙˆÙ‰ 11-20: Ø£Ù„ØºØ§Ø² Ù…Ù†Ø·Ù‚ÙŠØ©
            {q:"Ø¹ÙƒØ³ ÙƒÙ„Ù…Ø© Ù„ÙŠÙ„ØŸ", a:"Ù†Ù‡Ø§Ø±", hint:"Ø§Ù„ÙˆÙ‚Øª Ø§Ù„Ø°ÙŠ ØªØ´Ø±Ù‚ ÙÙŠÙ‡ Ø§Ù„Ø´Ù…Ø³"},
            {q:"Ø£Ù…Ù„Ùƒ Ù…ÙØ§ØªÙŠØ­ Ø¨Ù„Ø§ Ø£Ø¨ÙˆØ§Ø¨ØŸ", a:"Ø¨ÙŠØ§Ù†Ùˆ", hint:"Ø¢Ù„Ø© Ù…ÙˆØ³ÙŠÙ‚ÙŠØ©"},
            {q:"Ø¹Ø§ØµÙ…Ø© ÙØ±Ù†Ø³Ø§ØŸ", a:"Ø¨Ø§Ø±ÙŠØ³", hint:"Ù…Ø¯ÙŠÙ†Ø© Ø¨Ù‡Ø§ Ø¨Ø±Ø¬ Ø¥ÙŠÙÙ„"},
            {q:"Ø£Ù†Ø§ Ø£Ø¸Ù‡Ø± Ù„ÙŠÙ„Ø§Ù‹ ÙˆØ£Ø®ØªÙÙŠ Ù†Ù‡Ø§Ø±Ø§Ù‹ØŸ", a:"Ø§Ù„Ù‚Ù…Ø±", hint:"Ø¬Ø±Ù… Ø³Ù…Ø§ÙˆÙŠ"},
            {q:"Ø£ÙˆÙ„ Ø´Ù‡Ø± Ø¨Ø§Ù„Ø³Ù†Ø©ØŸ", a:"ÙŠÙ†Ø§ÙŠØ±", hint:"Ø§Ù„Ø´Ù‡Ø± Ø§Ù„Ø£ÙˆÙ„ ÙÙŠ Ø§Ù„ØªÙ‚ÙˆÙŠÙ… Ø§Ù„Ù…ÙŠÙ„Ø§Ø¯ÙŠ"},
            {q:"ÙƒÙ… Ø¹Ø¯Ø¯ Ø­Ø±ÙˆÙ AIØŸ", a:"2", hint:"AI = Ø­Ø±ÙÙŠÙ†"},
            {q:"Ù„ÙˆÙ† Ø§Ù„Ø³Ù…Ø§Ø¡ Ø§Ù„ØµØ§ÙÙŠØŸ", a:"Ø§Ø²Ø±Ù‚", hint:"Ù„ÙˆÙ† Ø§Ù„Ø¨Ø­Ø± Ø§Ù„ØµØ§ÙÙŠ"},
            {q:"Ø§Ù„ÙŠÙˆÙ… Ø¨Ø¹Ø¯ Ø§Ù„Ø§Ø«Ù†ÙŠÙ†ØŸ", a:"Ø§Ù„Ø«Ù„Ø§Ø«Ø§Ø¡", hint:"Ø«Ø§Ù†ÙŠ Ø£ÙŠØ§Ù… Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹"},
            {q:"Ø´ÙŠØ¡ ØªÙƒØªØ¨Ù‡ ÙˆÙ„Ø§ ØªØ±Ø§Ù‡ØŸ", a:"ÙÙƒØ±Ø©", hint:"Ø´ÙŠØ¡ ÙÙŠ Ø§Ù„Ø¹Ù‚Ù„"},
            {q:"Ø´ÙŠØ¡ ÙŠÙƒØ³ÙˆÙƒ ÙˆÙ‡Ùˆ Ø¹Ø§Ø±ÙØŸ", a:"Ø§Ù„Ø¥Ø¨Ø±Ø©", hint:"ØªØ³ØªØ®Ø¯Ù… ÙÙŠ Ø§Ù„Ø®ÙŠØ§Ø·Ø©"},
            
            // Ø§Ù„Ù…Ø³ØªÙˆÙ‰ 21-30: Ø£Ù„ØºØ§Ø² ØªØ´ÙÙŠØ±
            {q:"ÙÙƒ Ø§Ù„ØªØ´ÙÙŠØ±: 56 49 43 54 4F 52 59", a:"victory", hint:"Ø£Ø­Ø±Ù Ø³Øª Ø¹Ø´Ø±ÙŠØ© (Hex) Ø¥Ù„Ù‰ Ù†ØµÙˆØµ"},
            {q:"ÙÙƒ Ø§Ù„ØªØ´ÙÙŠØ±: 48 41 43 4B 45 52", a:"hacker", hint:"Hex Ø¥Ù„Ù‰ Ù†Øµ"},
            {q:"ROT13: Xrl", a:"key", hint:"ØªØ­ÙˆÙŠÙ„ ROT13"},
            {q:"Ø§Ù„ÙƒÙˆØ¯ Ø§Ù„Ø«Ù†Ø§Ø¦ÙŠ: 01001101 01000001", a:"ma", hint:"ØªØ­ÙˆÙŠÙ„ binary Ø¥Ù„Ù‰ Ù†Øµ"},
            {q:"Caesar Cipher (+3): Fdhvdu", a:"caesar", hint:"Ø£Ø­Ø±Ù Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ©"},
            {q:"Morse: .--. .-. ---", a:"pro", hint:"Ø´ÙØ±Ø© Ù…ÙˆØ±Ø³"},
            {q:"Base64: UHJvdG9jb2w=", a:"protocol", hint:"ÙÙƒ Base64"},
            {q:"ASCII: 72 65 6C 6C 6F", a:"hello", hint:"Ø£Ø±Ù‚Ø§Ù… ASCII"},
            {q:"Reverse: xelA", a:"Alex", hint:"Ø¹ÙƒØ³ Ø§Ù„ÙƒÙ„Ù…Ø©"},
            {q:"Atbash: Zgyzhs", a:"atbash", hint:"Ø´ÙØ±Ø© Atbash"},
            
            // Ø§Ù„Ù…Ø³ØªÙˆÙ‰ 31-40: Ø£Ù„ØºØ§Ø² Ø£Ù†Ù…ÙŠ
            {q:"Ù…Ù† Ù‡Ùˆ Ø´Ø®ØµÙŠØ© 'Ù†Ø§Ø±ÙˆØªÙˆ' Ø§Ù„ØªÙŠ Ø£ØµØ¨Ø­Øª Ù‡ÙˆÙƒØ§Ø¬ÙŠØŸ", a:"Ù†Ø§Ø±ÙˆØªÙˆ Ø£ÙˆØ²ÙˆÙ…Ø§ÙƒÙŠ", hint:"Ø§Ù„Ø´Ø®ØµÙŠØ© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© ÙÙŠ Ø§Ù„Ø£Ù†Ù…ÙŠ"},
            {q:"ÙÙŠ Ø£ÙŠ Ø­Ø±Ø¨ Ø§Ø³ØªØ®Ø¯Ù…Øª Ø§Ù„Ù€ 'Ù†ÙŠÙ†Ø¬Ø§ Ø§Ù„Ø­ØµØ§Ø± Ø§Ù„ÙƒØ¨ÙŠØ±'ØŸ", a:"Ø§Ù„Ø­Ø±Ø¨ Ø§Ù„Ø±Ø§Ø¨Ø¹Ø©", hint:"Ø§Ù„Ø­Ø±Ø¨ Ø§Ù„Ø±Ø§Ø¨Ø¹Ø© Ù„Ù„Ù†ÙŠÙ†Ø¬Ø§"},
            {q:"'Ø£Ù†Ø§ Ø³Ø£ØµØ¨Ø­ Ø£Ø¹Ø¸Ù… Ù‡ÙÙˆÙƒØ§Ø¬ÙŠ!' Ù…Ù† Ù‚Ø§Ù„ Ù‡Ø°Ù‡ØŸ", a:"Ù†Ø§Ø±ÙˆØªÙˆ", hint:"Ø§Ù„Ø´Ø®ØµÙŠØ© Ø§Ù„ØªÙŠ ØªØ­Ù„Ù… Ø¨Ø£Ù† ØªØµØ¨Ø­ Ù‡ÙˆÙƒØ§Ø¬ÙŠ"},
            {q:"Ø§ÙƒØªØ¨ Ø§Ø³Ù… Ø§Ù„Ù€ Sharingan Ø¨Ø§Ù„Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ©", a:"sharingan", hint:"Ø¹ÙŠÙ† Ø§Ù„Ø¯Ù…Ø¹Ø© ÙÙŠ Ù†Ø§Ø±ÙˆØªÙˆ"},
            {q:"ÙƒÙ… Ø¹Ø¯Ø¯ Ø§Ù„Ø£Ø¯Ù…ÙŠØ±Ø§Ù„Ø§Øª ÙÙŠ Ø¹Ø§Ù„Ù… Ø§Ù„Ø§Ù†Ù…ÙŠ 'ÙˆÙ† Ø¨ÙŠØ³'ØŸ", a:"3", hint:"Ø¹Ø¯Ø¯ Ø§Ù„Ø£Ø¯Ù…ÙŠØ±Ø§Ù„Ø§Øª ÙÙŠ Ø§Ù„Ù‚ÙˆØ§Øª Ø§Ù„Ø¨Ø­Ø±ÙŠØ©"},
            {q:"Ù…Ù† Ù‡Ùˆ Ù…Ù„Ùƒ Ø§Ù„Ù‚Ø±Ø§ØµÙ†Ø© ÙÙŠ ÙˆÙ† Ø¨ÙŠØ³ØŸ", a:"ØºÙˆÙ„ Ø¯ÙŠ Ø±ÙˆØ¬Ø±", hint:"Ø§Ù„Ù…Ù„Ùƒ Ø§Ù„Ø³Ø§Ø¨Ù‚"},
            {q:"Ù…Ø§ Ø§Ø³Ù… Ø§Ù„Ø³ÙÙŠÙ†Ø© ÙÙŠ ÙˆÙ† Ø¨ÙŠØ³ØŸ", a:"Ù…ÙŠØ±ÙŠ", hint:"Ø³ÙÙŠÙ†Ø© Ù„ÙˆÙÙŠ"},
            {q:"Ù…Ù† Ø£Ù†Ø´Ø£ Ø§Ù„Ø£ÙƒØ§Ø¯ÙŠÙ…ÙŠØ© ÙÙŠ Ù‡Ø¬ÙˆÙ… Ø§Ù„Ø¹Ù…Ø§Ù„Ù‚Ø©ØŸ", a:"Ø¥ÙŠØ±ÙŠÙ†", hint:"Ø§Ù„Ù…Ø¤Ø³Ø³"},
            {q:"ÙƒÙ… Ø¹Ø¯Ø¯ Ø£Ø·Ø±Ø§Ù Ø§Ù„Ø£ÙƒØªÙˆØ¨ÙˆØ´ ÙÙŠ Ø£Ù†Ù…ÙŠ 'Ø¯ÙƒØªÙˆØ± Ø³ØªÙˆÙ†'ØŸ", a:"8", hint:"Ù…Ø®Ù„ÙˆÙ‚ Ø¨Ø­Ø±ÙŠ"},
            {q:"Ù…Ø§ Ù‡ÙŠ Ø§Ù„Ù‚Ø±ÙŠØ© Ø§Ù„ØªÙŠ ÙŠÙ†ØªÙ…ÙŠ Ø¥Ù„ÙŠÙ‡Ø§ Ù†Ø§Ø±ÙˆØªÙˆØŸ", a:"ÙƒÙˆÙ†ÙˆÙ‡Ø§", hint:"Ù‚Ø±ÙŠØ© Ø§Ù„ÙˆØ±Ù‚"},
            
            // Ø§Ù„Ù…Ø³ØªÙˆÙ‰ 41-50: Ø£Ù„ØºØ§Ø² ØµØ¹Ø¨Ø©
            {q:"Ù…Ø§ Ù‡Ùˆ Ø§Ù„Ø¹Ø¯Ø¯ Ø§Ù„ØªØ§Ù„ÙŠ: 2, 4, 8, 16, ?", a:"32", hint:"Ù…Ø¶Ø§Ø¹ÙØ© Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø§Ø¨Ù‚"},
            {q:"Ù…Ø§ Ù‡Ùˆ Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ù…ÙÙ‚ÙˆØ¯: 1, 1, 2, 3, 5, 8, ?", a:"13", hint:"Ù…ØªØªØ§Ù„ÙŠØ© ÙÙŠØ¨ÙˆÙ†Ø§ØªØ´ÙŠ"},
            {q:"Ø­Ù„ Ø§Ù„Ù…Ø¹Ø§Ø¯Ù„Ø©: 3x + 7 = 22", a:"5", hint:"x = ?"},
            {q:"Ù…Ø§ Ù‡Ùˆ Ø§Ù„Ø¹Ø¯Ø¯ Ø§Ù„Ø£ÙˆÙ„ÙŠ Ø¨Ø¹Ø¯ 20ØŸ", a:"23", hint:"Ø¹Ø¯Ø¯ Ø£ÙˆÙ„ÙŠ"},
            {q:"ÙƒÙ… Ø¹Ø¯Ø¯ Ø­ÙˆØ§Ù Ø§Ù„Ù…ÙƒØ¹Ø¨ØŸ", a:"12", hint:"Ø´ÙƒÙ„ Ø«Ù„Ø§Ø«ÙŠ Ø§Ù„Ø£Ø¨Ø¹Ø§Ø¯"},
            {q:"Ù…Ø§ Ù‡Ùˆ Ø¬Ø°Ø± 144ØŸ", a:"12", hint:"âˆš144 = ?"},
            {q:"5! (Ø¹Ø§Ù…Ù„ÙŠ) = ?", a:"120", hint:"5 Ã— 4 Ã— 3 Ã— 2 Ã— 1"},
            {q:"Ù…Ø§ Ù‡Ùˆ 2^8ØŸ", a:"256", hint:"2 Ø£Ø³ 8"},
            {q:"Ø­ÙˆÙ„ 1010 Ø§Ù„Ø«Ù†Ø§Ø¦ÙŠ Ø¥Ù„Ù‰ Ø¹Ø´Ø±ÙŠ", a:"10", hint:"Binary Ø¥Ù„Ù‰ Decimal"},
            {q:"Ù…Ø§ Ù‡Ùˆ Ø§Ù„Ø¹Ø¯Ø¯ Ø§Ù„Ø°ÙŠ Ø¥Ø°Ø§ Ø¶Ø±Ø¨ ÙÙŠ Ù†ÙØ³Ù‡ ÙŠØ¹Ø·ÙŠ 625ØŸ", a:"25", hint:"âˆš625 = ?"}
        ];
        
        // === Ù…Ø±Ø­Ù„Ø© Ø³Ø±ÙŠØ© (Ø¥Ø°Ø§ Ø£Ø¬Ø¨Ù†Ø§ 3 Ù…Ø±Ø§Ø­Ù„ ÙÙŠ Ø£Ù‚Ù„ Ù…Ù† 10 Ø«ÙˆØ§Ù†ÙŠ) ===
        const secretRiddle = {
            q: "ğŸš¨ Ù…Ø±Ø­Ù„Ø© Ø³Ø±ÙŠØ©: Ù…Ø§ Ù‡Ùˆ ÙƒÙˆØ¯ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø¥Ù„Ù‰ Ø§Ù„Ø®Ø§Ø¯Ù… Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØŸ (ÙƒÙ„Ù…Ø©: police)",
            a: "accessgranted",
            hint: "Ù‡Ø°Ù‡ Ø§Ù„Ù…Ø±Ø­Ù„Ø© Ø§Ù„Ø³Ø±ÙŠØ© ØªØ­ØªØ§Ø¬ Ø¥Ù„Ù‰ Ø§Ù„ÙƒÙˆØ¯ Ø§Ù„Ø³Ø±ÙŠ Ù„Ù„Ø¯Ø®ÙˆÙ„"
        };
        
        // === Ù†Ø¸Ø§Ù… Ø§Ù„Ù…Ø³ØªÙˆÙŠØ§Øª ===
        const difficulties = {
            easy: {
                name: "Ø³Ù‡Ù„",
                hintPenalty: 2,
                timeBonusMultiplier: 1.5,
                unlimitedHints: true,
                color: "#00ff66"
            },
            medium: {
                name: "Ù…ØªÙˆØ³Ø·",
                hintPenalty: 5,
                timeBonusMultiplier: 1.0,
                unlimitedHints: false,
                color: "#ffcc00"
            },
            hard: {
                name: "ØµØ¹Ø¨",
                hintPenalty: 8,
                timeBonusMultiplier: 0.7,
                unlimitedHints: false,
                color: "#ff3333"
            }
        };
        
        // === Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ÙƒÙ„Ù…Ø© Ø§Ù„Ø³Ø± Ù…Ø¹ Ø­ÙØ¸ Ø§Ù„ØªÙ‚Ø¯Ù… ===
        function checkPassword() {
            const passwordInput = document.getElementById("password").value.trim().toLowerCase();
            const errorMsg = document.getElementById("errorMsg");
            selectedDifficulty = document.getElementById("difficulty").value;
            
            if (passwordInput === SECRET_PASSWORD) {
                // ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØªÙ‚Ø¯Ù… Ø§Ù„Ù…Ø­ÙÙˆØ¸
                loadGameProgress();
                
                // Ø¯Ø®ÙˆÙ„ Ù†Ø§Ø¬Ø­
                document.getElementById("loginScreen").style.display = "none";
                document.getElementById("storyScreen").style.display = "flex";
                document.getElementById("leaderboardBtn").style.display = "block";
                
                // Ø¶Ø¨Ø· Ø§Ù„ØªÙ„Ù…ÙŠØ­Ø§Øª Ø­Ø³Ø¨ Ø§Ù„Ù…Ø³ØªÙˆÙ‰
                totalHints = difficulties[selectedDifficulty].unlimitedHints ? 999 : 3;
                
                // ØªØ­Ø¯ÙŠØ« ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
                document.getElementById("difficultyBadge").innerText = difficulties[selectedDifficulty].name;
                document.getElementById("difficultyBadge").style.background = `rgba(${
                    selectedDifficulty === 'easy' ? '0,255,102' : 
                    selectedDifficulty === 'medium' ? '255,204,0' : '255,51,51'
                }, 0.3)`;
                
                // ØªØ£Ø«ÙŠØ± ØµÙˆØªÙŠ
                playSound("success");
            } else {
                // Ø¯Ø®ÙˆÙ„ ÙØ§Ø´Ù„
                errorMsg.innerHTML = "âŒ ÙƒÙ„Ù…Ø© Ø³Ø± Ø®Ø§Ø·Ø¦Ø©! Ø­Ø§ÙˆÙ„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰.";
                document.getElementById("password").style.borderColor = "#ff3300";
                document.getElementById("password").style.animation = "shake 0.5s";
                document.getElementById("password").value = "";
                
                setTimeout(() => {
                    document.getElementById("password").style.animation = "";
                    document.getElementById("password").style.borderColor = "#00ffcc";
                    errorMsg.innerHTML = "";
                }, 2000);
                
                playSound("error");
            }
        }
        
        // === Ø­ÙØ¸ Ø§Ù„ØªÙ‚Ø¯Ù… ===
        function saveGameProgress() {
            const progress = {
                stage: currentStage,
                score: score,
                time: totalTime,
                hintsUsed: hintsUsed,
                difficulty: selectedDifficulty,
                correctAnswers: correctAnswers,
                secretStageUnlocked: secretStageUnlocked,
                date: new Date().toISOString()
            };
            localStorage.setItem('protocolX_progress', JSON.stringify(progress));
        }
        
        // === ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØªÙ‚Ø¯Ù… ===
        function loadGameProgress() {
            const saved = JSON.parse(localStorage.getItem('protocolX_progress'));
            if (saved) {
                if (confirm("ØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ ØªÙ‚Ø¯Ù… Ù…Ø­ÙÙˆØ¸. Ù‡Ù„ ØªØ±ÙŠØ¯ Ø§Ù„Ø§Ø³ØªÙ…Ø±Ø§Ø± Ù…Ù† Ø­ÙŠØ« ØªÙˆÙ‚ÙØªØŸ")) {
                    currentStage = saved.stage || 0;
                    score = saved.score || 0;
                    totalTime = saved.time || 0;
                    hintsUsed = saved.hintsUsed || 0;
                    selectedDifficulty = saved.difficulty || "medium";
                    correctAnswers = saved.correctAnswers || 0;
                    secretStageUnlocked = saved.secretStageUnlocked || false;
                    
                    // ØªØ­Ø¯ÙŠØ« Ø§Ù„ÙˆØ§Ø¬Ù‡Ø©
                    document.getElementById("score").innerText = score;
                    document.getElementById("timer").innerText = totalTime;
                    document.getElementById("difficulty").value = selectedDifficulty;
                } else {
                    // Ø¨Ø¯Ø¡ Ù„Ø¹Ø¨Ø© Ø¬Ø¯ÙŠØ¯Ø©
                    resetGameProgress();
                }
            }
        }
        
        // === Ù…Ø³Ø­ Ø§Ù„ØªÙ‚Ø¯Ù… ===
        function resetGameProgress() {
            currentStage = 0;
            score = 0;
            totalTime = 0;
            hintsUsed = 0;
            correctAnswers = 0;
            secretStageUnlocked = false;
            fastAnswersCount = 0;
            
            localStorage.removeItem('protocolX_progress');
        }
        
        // === Ø¥ØºÙ„Ø§Ù‚ Ø´Ø§Ø´Ø© Ø§Ù„Ù‚ØµØ© ÙˆØ¨Ø¯Ø¡ Ø§Ù„Ù„Ø¹Ø¨Ø© ===
        function closeStory() {
            document.getElementById("storyScreen").style.display = "none";
            document.getElementById("gameHeader").style.display = "flex";
            document.getElementById("gameContainer").style.display = "block";
            document.getElementById("gameFooter").style.display = "flex";
            
            gameActive = true;
            loadStage();
            startTimer();
            createParticles(50);
        }
        
        // === ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ù…Ø±Ø­Ù„Ø© ===
        function loadStage() {
            if (!gameActive) return;
            
            // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ù…Ø±Ø­Ù„Ø© Ø§Ù„Ø³Ø±ÙŠØ©
            if (secretStageUnlocked && currentStage === 25) {
                document.getElementById("stageTitle").innerHTML = `ğŸš¨ Ø§Ù„Ù…Ø±Ø­Ù„Ø© Ø§Ù„Ø³Ø±ÙŠØ© <span class="secret-badge">Ø®Ø§ØµØ©</span>`;
                document.getElementById("question").innerText = secretRiddle.q;
                document.getElementById("hintText").innerText = secretRiddle.hint;
            } else {
                document.getElementById("stageTitle").innerText = `Ø§Ù„Ù…Ø±Ø­Ù„Ø© ${currentStage + 1}`;
                document.getElementById("stageNum").innerText = currentStage + 1;
                document.getElementById("question").innerText = riddles[currentStage].q;
                document.getElementById("hintText").innerText = "Ø§ÙƒØªØ¨ Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø© ÙÙŠ Ø§Ù„Ø­Ù‚Ù„ Ø£Ø¯Ù†Ø§Ù‡";
            }
            
            document.getElementById("answer").value = "";
            
            // ØªØ­Ø¯ÙŠØ« Ø¹Ø¯Ø¯ Ø§Ù„ØªÙ„Ù…ÙŠØ­Ø§Øª Ø§Ù„Ù…ØªØ¨Ù‚ÙŠØ©
            const hintsLeft = totalHints - hintsUsed;
            document.getElementById("hintCounter").innerText = difficulties[selectedDifficulty].unlimitedHints ? "âˆ" : hintsLeft;
            document.getElementById("hintBtn").innerHTML = `<i class="fas fa-question-circle"></i> Ù…Ø³Ø§Ø¹Ø¯Ø© (<span id="hintCounter">${difficulties[selectedDifficulty].unlimitedHints ? "âˆ" : hintsLeft}</span>/${difficulties[selectedDifficulty].unlimitedHints ? "âˆ" : totalHints})`;
            
            // ØªØ­Ø¯ÙŠØ« Ø´Ø±ÙŠØ· Ø§Ù„ØªÙ‚Ø¯Ù…
            const progressPercent = ((currentStage + 1) / riddles.length) * 100;
            document.getElementById("progressFill").style.width = `${progressPercent}%`;
            
            stageTime = 0;
            document.getElementById("answer").focus();
            
            // Ø­ÙØ¸ Ø§Ù„ØªÙ‚Ø¯Ù… ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹
            saveGameProgress();
        }
        
        // === Ø¨Ø¯Ø¡ Ø§Ù„Ù…Ø¤Ù‚Øª ===
        function startTimer() {
            setInterval(() => {
                if (gameActive) {
                    totalTime++;
                    stageTime++;
                    document.getElementById("timer").innerText = totalTime;
                }
            }, 1000);
        }
        
        // === Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø© ===
        function checkAnswer() {
            if (!gameActive) return;
            
            const userAnswer = document.getElementById("answer").value.trim().toLowerCase();
            let correctAnswer;
            
            // ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø© Ø§Ù„ØµØ­ÙŠØ­Ø© (Ø¹Ø§Ø¯ÙŠ Ø£Ùˆ Ù…Ø±Ø­Ù„Ø© Ø³Ø±ÙŠØ©)
            if (secretStageUnlocked && currentStage === 25) {
                correctAnswer = secretRiddle.a.toLowerCase();
            } else {
                correctAnswer = riddles[currentStage].a.toLowerCase();
            }
            
            if (userAnswer === correctAnswer) {
                // Ø­Ø³Ø§Ø¨ Ø§Ù„Ù†Ù‚Ø§Ø· Ø¨Ù†Ø§Ø¡ Ø¹Ù„Ù‰ Ø§Ù„ØµØ¹ÙˆØ¨Ø© ÙˆØ§Ù„ÙˆÙ‚Øª
                const difficultyMultiplier = difficulties[selectedDifficulty].timeBonusMultiplier;
                const timeBonus = Math.max(15 - Math.floor(stageTime / 5), 5) * difficultyMultiplier;
                score += Math.round(10 + timeBonus);
                correctAnswers++;
                
                // ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø§Øª Ø§Ù„Ø³Ø±ÙŠØ¹Ø© Ù„Ù„Ù…Ø±Ø­Ù„Ø© Ø§Ù„Ø³Ø±ÙŠØ©
                if (stageTime < 10) {
                    fastAnswersCount++;
                    if (fastAnswersCount >= 3 && !secretStageUnlocked) {
                        secretStageUnlocked = true;
                        alert("ğŸ‰ Ù„Ù‚Ø¯ ÙØªØ­Øª Ù…Ø±Ø­Ù„Ø© Ø³Ø±ÙŠØ©! Ø³ØªØµØ¨Ø­ Ù…ØªØ§Ø­Ø© ÙÙŠ Ø§Ù„Ù…Ø±Ø­Ù„Ø© 25.");
                    }
                } else {
                    fastAnswersCount = 0;
                }
                
                // ØªØ£Ø«ÙŠØ± Ø¨ØµØ±ÙŠ Ù„Ù„Ø¥Ø¬Ø§Ø¨Ø© Ø§Ù„ØµØ­ÙŠØ­Ø©
                document.getElementById("box").style.boxShadow = "0 0 40px rgba(0, 255, 100, 0.7)";
                document.getElementById("box").style.borderColor = "#00ff66";
                
                // Ø¬Ø³ÙŠÙ…Ø§Øª Ù†Ø¬Ø§Ø­
                createParticles(20);
                
                setTimeout(() => {
                    document.getElementById("box").style.boxShadow = "0 0 30px rgba(0, 255, 204, 0.4)";
                    document.getElementById("box").style.borderColor = "rgba(0, 255, 204, 0.2)";
                }, 500);
                
                // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù†Ù‚Ø§Ø·
                document.getElementById("score").innerText = score;
                
                // Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ù„Ù„Ù…Ø±Ø­Ù„Ø© Ø§Ù„ØªØ§Ù„ÙŠØ©
                currentStage++;
                
                // Ø¹Ø±Ø¶ Ù‚ØµØ© ÙƒÙ„ 10 Ù…Ø±Ø§Ø­Ù„
                if (currentStage % 10 === 0 && currentStage < riddles.length) {
                    showStoryProgress();
                } else if (currentStage < riddles.length) {
                    // Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ø§Ù„Ø¹Ø§Ø¯ÙŠ Ø¨ÙŠÙ† Ø§Ù„Ù…Ø±Ø§Ø­Ù„
                    document.getElementById("box").classList.add("fade-out");
                    setTimeout(() => {
                        document.getElementById("box").classList.remove("fade-out");
                        document.getElementById("box").classList.add("fade-in");
                        loadStage();
                        createParticles(10);
                    }, 400);
                } else {
                    finishGame();
                }
                
                // Ø­ÙØ¸ Ø§Ù„ØªÙ‚Ø¯Ù…
                saveGameProgress();
                
            } else {
                // ØªØ£Ø«ÙŠØ± Ù„Ù„Ø¥Ø¬Ø§Ø¨Ø© Ø§Ù„Ø®Ø§Ø·Ø¦Ø©
                document.getElementById("box").style.animation = "shake 0.5s";
                document.getElementById("answer").style.borderColor = "#ff3300";
                document.getElementById("answer").style.boxShadow = "0 0 10px rgba(255, 50, 0, 0.5)";
                
                setTimeout(() => {
                    document.getElementById("box").style.animation = "";
                    document.getElementById("answer").style.borderColor = "#00ffcc";
                    document.getElementById("answer").style.boxShadow = "";
                }, 500);
                
                // Ø®ØµÙ… Ù†Ù‚Ø§Ø· Ù„Ù„Ø¥Ø¬Ø§Ø¨Ø© Ø§Ù„Ø®Ø§Ø·Ø¦Ø© Ø­Ø³Ø¨ Ø§Ù„ØµØ¹ÙˆØ¨Ø©
                const penalty = difficulties[selectedDifficulty].hintPenalty;
                score = Math.max(score - penalty, 0);
                document.getElementById("score").innerText = score;
                
                // Ø¬Ø³ÙŠÙ…Ø§Øª Ø®Ø·Ø£
                createErrorParticles();
                alert(`âŒ Ø¥Ø¬Ø§Ø¨Ø© Ø®Ø§Ø·Ø¦Ø©! Ø®Ø³Ø±Øª ${penalty} Ù†Ù‚Ø·Ø©. Ø­Ø§ÙˆÙ„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰.`);
            }
        }
        
        // === Ø¹Ø±Ø¶ ØªÙ„Ù…ÙŠØ­ ===
        function showHint() {
            if (!difficulties[selectedDifficulty].unlimitedHints && hintsUsed >= totalHints) {
                alert("Ù„Ù‚Ø¯ Ø§Ø³ØªØ®Ø¯Ù…Øª Ø¬Ù…ÙŠØ¹ Ø§Ù„ØªÙ„Ù…ÙŠØ­Ø§Øª Ø§Ù„Ù…ØªØ§Ø­Ø©!");
                return;
            }
            
            let hintText;
            if (secretStageUnlocked && currentStage === 25) {
                hintText = secretRiddle.hint;
            } else {
                hintText = riddles[currentStage].hint;
            }
            
            document.getElementById("hintText").innerText = hintText;
            hintsUsed++;
            
            // ØªØ­Ø¯ÙŠØ« Ø²Ø± Ø§Ù„ØªÙ„Ù…ÙŠØ­
            const hintsLeft = totalHints - hintsUsed;
            document.getElementById("hintCounter").innerText = difficulties[selectedDifficulty].unlimitedHints ? "âˆ" : hintsLeft;
            
            // Ø®ØµÙ… Ù†Ù‚Ø§Ø· Ø¹Ù†Ø¯ Ø§Ø³ØªØ®Ø¯Ø§Ù… ØªÙ„Ù…ÙŠØ­
            const penalty = difficulties[selectedDifficulty].hintPenalty;
            score = Math.max(score - penalty, 0);
            document.getElementById("score").innerText = score;
            
            // ØªØ£Ø«ÙŠØ± Ø§Ù„ØªÙ„Ù…ÙŠØ­
            document.getElementById("hintBtn").style.background = "rgba(0, 100, 255, 0.4)";
            setTimeout(() => {
                document.getElementById("hintBtn").style.background = "";
            }, 1000);
            
            // Ø¬Ø³ÙŠÙ…Ø§Øª ØªÙ„Ù…ÙŠØ­
            createHintParticles();
            
            alert(`ğŸ’¡ Ø§Ø³ØªØ®Ø¯Ù…Øª ØªÙ„Ù…ÙŠØ­Ù‹Ø§! Ø®Ø³Ø±Øª ${penalty} Ù†Ù‚Ø·Ø©.`);
            
            // Ø­ÙØ¸ Ø§Ù„ØªÙ‚Ø¯Ù…
            saveGameProgress();
        }
        
        // === Ø¹Ø±Ø¶ Ù‚ØµØ© Ø§Ù„ØªÙ‚Ø¯Ù… ===
        function showStoryProgress() {
            gameActive = false;
            const storyTitle = document.getElementById("storyTitle");
            const storyText = document.getElementById("storyText");
            
            if (currentStage === 10) {
                storyTitle.innerText = "Ø§Ù„Ø¨Ø±ÙˆØªÙˆÙƒÙˆÙ„ 10/50";
                storyText.innerHTML = `
                    Ø£Ø­Ø³Ù†Øª! Ù„Ù‚Ø¯ Ø§Ø®ØªØ±Ù‚Øª <span class="highlight">10 Ø¨Ø±ÙˆØªÙˆÙƒÙˆÙ„Ø§Øª</span> Ø¨Ù†Ø¬Ø§Ø­.<br><br>
                    Ø§ÙƒØªØ´ÙØª Ø£Ù† Ø§Ù„Ø´Ø¨ÙƒØ© Ø§Ù„Ø¥Ø¬Ø±Ø§Ù…ÙŠØ© ØªØ³ØªØ®Ø¯Ù… <span class="highlight">Ø®ÙˆØ§Ø¯Ù… ÙˆÙ‡Ù…ÙŠØ©</span> Ù„ØªØ¶Ù„ÙŠÙ„ Ø§Ù„Ù…Ø­Ù‚Ù‚ÙŠÙ†.<br><br>
                    Ø§Ù„Ù…Ø¯ÙŠØ± ÙŠØ·Ù„Ø¨ Ù…Ù†Ùƒ Ø§Ù„ØªÙˆØ¬Ù‡ Ø¥Ù„Ù‰ <span class="highlight">Ø§Ù„Ù‚Ø·Ø§Ø¹ B</span> Ø­ÙŠØ« ØªÙˆØ¬Ø¯ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠØ©.<br><br>
                    <span style="color:#ff3333">âš  Ø§Ù†ØªØ¨Ù‡:</span> Ø§Ù„Ù‚Ø·Ø§Ø¹ B Ù…Ø­Ù…ÙŠ Ø¨Ø£Ù†Ø¸Ù…Ø© ÙƒØ´Ù Ù…ØªÙ‚Ø¯Ù…Ø©!
                `;
            } else if (currentStage === 20) {
                storyTitle.innerText = "Ø§Ù„Ø¨Ø±ÙˆØªÙˆÙƒÙˆÙ„ 20/50";
                storyText.innerHTML = `
                    ØªÙ‚Ø¯Ù… Ø±Ø§Ø¦Ø¹! <span class="highlight">20 Ø¨Ø±ÙˆØªÙˆÙƒÙˆÙ„Ù‹Ø§</span> ØªÙ… Ø§Ø®ØªØ±Ø§Ù‚Ù‡Ø§.<br><br>
                    Ù„Ù‚Ø¯ ÙˆØµÙ„Øª Ø¥Ù„Ù‰ <span class="highlight">Ø§Ù„Ø®Ø§Ø¯Ù… Ø§Ù„Ù…Ø±ÙƒØ²ÙŠ</span> ÙˆÙˆØ¬Ø¯Øª Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø´ØªØ¨Ù‡ Ø¨Ù‡Ù….<br><br>
                    Ø§Ù„Ù‚Ø§Ø¦Ø¯ Ø§Ù„Ø¹Ø§Ù… ÙŠØ·Ù„Ø¨ ØªØ³Ø±ÙŠØ¹ Ø§Ù„Ø¹Ù…Ù„ÙŠØ© Ù‚Ø¨Ù„ Ø£Ù† <span class="highlight">ÙŠØªÙ… Ù…Ø­Ùˆ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</span>.<br><br>
                    <span style="color:#00ff66">ğŸ¯ Ù‡Ø¯Ù Ø¬Ø¯ÙŠØ¯:</span> Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø§Ù„Ø²Ø¹ÙŠÙ… Ø§Ù„Ø®ÙÙŠ "Ù…Ø§ØªØ±ÙŠÙƒØ³"!
                `;
            } else if (currentStage === 30) {
                storyTitle.innerText = "Ø§Ù„Ø¨Ø±ÙˆØªÙˆÙƒÙˆÙ„ 30/50";
                storyText.innerHTML = `
                    Ø¥Ù†Ø¬Ø§Ø² Ù…Ù…ØªØ§Ø²! <span class="highlight">30 Ø¨Ø±ÙˆØªÙˆÙƒÙˆÙ„Ù‹Ø§</span> Ù„Ù… ØªØµÙ…Ø¯ Ø£Ù…Ø§Ù…Ùƒ.<br><br>
                    Ø§ÙƒØªØ´ÙØª Ø£Ù† <span class="highlight">"Ù…Ø§ØªØ±ÙŠÙƒØ³"</span> Ù„ÙŠØ³ Ø´Ø®ØµÙ‹Ø§ Ø¨Ù„ Ø¨Ø±Ù†Ø§Ù…Ø¬ Ø°ÙƒØ§Ø¡ Ø§ØµØ·Ù†Ø§Ø¹ÙŠ.<br><br>
                    Ø§Ù„Ø¨Ø±Ù†Ø§Ù…Ø¬ ÙŠØ­Ø§ÙˆÙ„ Ø§Ù„Ø¢Ù† <span class="highlight">ØªØ¹Ù‚Ø¨ Ù…ÙˆÙ‚Ø¹Ùƒ</span>! ÙŠØ¬Ø¨ Ø§Ù„Ø¥Ø³Ø±Ø§Ø¹.<br><br>
                    <span style="color:#ffcc00">ğŸ’° Ù…ÙƒØ§ÙØ£Ø©:</span> 50,000 Ø¯ÙˆÙ„Ø§Ø± Ù„Ù…Ù† ÙŠÙƒÙ…Ù„ Ø§Ù„Ù…Ù‡Ù…Ø©!
                `;
            } else if (currentStage === 40) {
                storyTitle.innerText = "Ø§Ù„Ø¨Ø±ÙˆØªÙˆÙƒÙˆÙ„ 40/50";
                storyText.innerHTML = `
                    <span class="highlight">40 Ø¨Ø±ÙˆØªÙˆÙƒÙˆÙ„Ù‹Ø§</span> ÙˆØªØ¨Ù‚Ù‰ 10 ÙÙ‚Ø· Ù„Ù„ÙÙˆØ²!<br><br>
                    Ø£Ù†Øª Ø¹Ù„Ù‰ ÙˆØ´Ùƒ Ø§Ø®ØªØ±Ø§Ù‚ <span class="highlight">Ø§Ù„Ø®Ø§Ø¯Ù… Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ</span> Ø­ÙŠØ« ØªÙˆØ¬Ø¯ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ø³Ø±Ø§Ø±.<br><br>
                    ÙˆØ­Ø¯Ø© Ø§Ù„Ø¯Ø¹Ù… Ø§Ù„ØªÙ‚Ù†ÙŠ ØªØ±Ø³Ù„ Ù„Ùƒ <span class="highlight">Ø£Ø¯ÙˆØ§Øª Ù…ØªØ·ÙˆØ±Ø©</span> Ù„Ù„Ù…Ø±Ø§Ø­Ù„ Ø§Ù„Ø£Ø®ÙŠØ±Ø©.<br><br>
                    <span style="color:#ff3333">ğŸš¨ Ø¥Ù†Ø°Ø§Ø± Ø£Ø®ÙŠØ±:</span> Ø¥Ø°Ø§ ÙØ´Ù„Øª Ø§Ù„Ø¢Ù†ØŒ Ø³ØªÙ‡Ø±Ø¨ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ø¯Ù„Ø©!
                `;
            }
            
            document.getElementById("storyScreen").style.display = "flex";
            document.getElementById("continueBtn").innerHTML = '<i class="fas fa-forward"></i> ØªØ§Ø¨Ø¹ Ø§Ù„Ù…Ù‡Ù…Ø©';
        }
        
        // === Ø§Ù†ØªÙ‡Ø§Ø¡ Ø§Ù„Ù„Ø¹Ø¨Ø© ===
        function finishGame() {
            gameActive = false;
            
            // ØªØ­Ø¯ÙŠØ« Ø´Ø§Ø´Ø© Ø§Ù„Ù†Ù‡Ø§ÙŠØ©
            document.getElementById("finalScore").innerText = score;
            document.getElementById("finalTime").innerText = totalTime;
            document.getElementById("finalDifficulty").innerText = difficulties[selectedDifficulty].name;
            
            // Ø­Ø³Ø§Ø¨ Ù†Ø³Ø¨Ø© Ø§Ù„Ù†Ø¬Ø§Ø­
            const successRate = Math.round((correctAnswers / riddles.length) * 100);
            document.getElementById("successRate").innerText = successRate;
            
            // Ø­ÙØ¸ Ø§Ù„Ù†ØªÙŠØ¬Ø© ÙÙŠ Ù„ÙˆØ­Ø© Ø§Ù„Ù…ØªØµØ¯Ø±ÙŠÙ†
            saveToLeaderboard();
            
            // Ø¹Ø±Ø¶ Ø´Ø§Ø´Ø© Ø§Ù„Ù†Ù‡Ø§ÙŠØ©
            document.getElementById("endScreen").style.display = "flex";
            
            // ØªØ£Ø«ÙŠØ±Ø§Øª Ø§Ù„Ù†ØµØ±
            createConfetti();
            playSound("success");
            
            // Ù…Ø³Ø­ Ø§Ù„ØªÙ‚Ø¯Ù… Ø¨Ø¹Ø¯ Ø§Ù„Ø§Ù†ØªÙ‡Ø§Ø¡
            localStorage.removeItem('protocolX_progress');
        }
        
        // === Ø¥Ø¹Ø§Ø¯Ø© ØªØ´ØºÙŠÙ„ Ø§Ù„Ù„Ø¹Ø¨Ø© ===
        function restartGame() {
            resetGameProgress();
            gameActive = true;
            
            document.getElementById("score").innerText = score;
            document.getElementById("timer").innerText = totalTime;
            document.getElementById("endScreen").style.display = "none";
            document.getElementById("gameHeader").style.display = "flex";
            document.getElementById("gameContainer").style.display = "block";
            
            loadStage();
            createParticles(30);
        }
        
        // === Ù„ÙˆØ­Ø© Ø§Ù„Ù…ØªØµØ¯Ø±ÙŠÙ† ===
        function saveToLeaderboard() {
            const leaderboard = JSON.parse(localStorage.getItem('protocolX_leaderboard')) || [];
            
            const playerEntry = {
                name: playerName,
                score: score,
                time: totalTime,
                difficulty: selectedDifficulty,
                date: new Date().toLocaleDateString('ar-SA'),
                successRate: Math.round((correctAnswers / riddles.length) * 100)
            };
            
            leaderboard.push(playerEntry);
            
            // ØªØ±ØªÙŠØ¨ Ø­Ø³Ø¨ Ø§Ù„Ù†Ù‚Ø§Ø· (ØªÙ†Ø§Ø²Ù„ÙŠ)
            leaderboard.sort((a, b) => b.score - a.score);
            
            // Ø­ÙØ¸ Ø£ÙØ¶Ù„ 10 ÙÙ‚Ø·
            localStorage.setItem('protocolX_leaderboard', JSON.stringify(leaderboard.slice(0, 10)));
        }
        
        function showLeaderboard() {
            const leaderboard = JSON.parse(localStorage.getItem('protocolX_leaderboard')) || [];
            const tableBody = document.getElementById("leaderboardBody");
            
            tableBody.innerHTML = "";
            
            if (leaderboard.length === 0) {
                tableBody.innerHTML = `
                    <tr>
                        <td colspan="5" style="color: #aaa; padding: 30px;">
                            <i class="fas fa-trophy" style="font-size: 2rem; margin-bottom: 10px; display: block;"></i>
                            Ù„Ø§ ØªÙˆØ¬Ø¯ Ø³Ø¬Ù„Ø§Øª Ø­ØªÙ‰ Ø§Ù„Ø¢Ù†!<br>
                            ÙƒÙ† Ø£ÙˆÙ„ Ù…Ù† ÙŠÙƒÙ…Ù„ Ø§Ù„Ù…Ù‡Ù…Ø©.
                        </td>
                    </tr>
                `;
            } else {
                leaderboard.forEach((entry, index) => {
                    const row = document.createElement("tr");
                    
                    // ØªÙ„ÙˆÙŠÙ† Ø§Ù„Ù…Ø±ÙƒØ² Ø§Ù„Ø£ÙˆÙ„
                    const medal = index === 0 ? 'ğŸ¥‡' : index === 1 ? 'ğŸ¥ˆ' : index === 2 ? 'ğŸ¥‰' : (index + 1) + '.';
                    
                    row.innerHTML = `
                        <td>${medal}</td>
                        <td><strong>${entry.name}</strong></td>
                        <td style="color: #00ffcc;">${entry.score}</td>
                        <td>${entry.time} Ø«</td>
                        <td><span style="color: ${
                            entry.difficulty === 'easy' ? '#00ff66' : 
                            entry.difficulty === 'medium' ? '#ffcc00' : '#ff3333'
                        }">${difficulties[entry.difficulty].name}</span></td>
                    `;
                    
                    tableBody.appendChild(row);
                });
            }
            
            document.getElementById("leaderboardScreen").style.display = "flex";
        }
        
        function closeLeaderboard() {
            document.getElementById("leaderboardScreen").style.display = "none";
        }
        
        function clearLeaderboard() {
            if (confirm("Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ù…Ø³Ø­ Ø¬Ù…ÙŠØ¹ Ø³Ø¬Ù„Ø§Øª Ø§Ù„Ù…ØªØµØ¯Ø±ÙŠÙ†ØŸ")) {
                localStorage.removeItem('protocolX_leaderboard');
                showLeaderboard();
                alert("ØªÙ… Ù…Ø³Ø­ Ù„ÙˆØ­Ø© Ø§Ù„Ù…ØªØµØ¯Ø±ÙŠÙ†.");
            }
        }
        
        // === ØªØ£Ø«ÙŠØ±Ø§Øª Ø§Ù„Ø¬Ø³ÙŠÙ…Ø§Øª ===
        function createParticles(count) {
            const box = document.getElementById("box");
            const rect = box.getBoundingClientRect();
            
            for (let i = 0; i < count; i++) {
                const particle = document.createElement("div");
                particle.classList.add("particle");
                
                particle.style.left = `${rect.left + Math.random() * rect.width}px`;
                particle.style.top = `${rect.top + Math.random() * rect.height}px`;
                
                const size = Math.random() * 6 + 2;
                particle.style.width = `${size}px`;
                particle.style.height = `${size}px`;
                particle.style.backgroundColor = `hsl(${Math.random() * 60 + 150}, 100%, 60%)`;
                
                document.body.appendChild(particle);
                
                const angle = Math.random() * Math.PI * 2;
                const speed = Math.random() * 3 + 2;
                const dx = Math.cos(angle) * speed;
                const dy = Math.sin(angle) * speed;
                
                let posX = parseFloat(particle.style.left);
                let posY = parseFloat(particle.style.top);
                
                const animate = () => {
                    posX += dx;
                    posY += dy;
                    particle.style.left = `${posX}px`;
                    particle.style.top = `${posY}px`;
                    particle.style.opacity = parseFloat(particle.style.opacity || 1) - 0.02;
                    
                    if (parseFloat(particle.style.opacity || 1) > 0) {
                        requestAnimationFrame(animate);
                    } else {
                        particle.remove();
                    }
                };
                
                animate();
            }
        }
        
        // === Ø¬Ø³ÙŠÙ…Ø§Øª Ø§Ù„Ø®Ø·Ø£ ===
        function createErrorParticles() {
            const box = document.getElementById("box");
            const rect = box.getBoundingClientRect();
            
            for (let i = 0; i < 15; i++) {
                const particle = document.createElement("div");
                particle.classList.add("particle");
                particle.style.left = `${rect.left + rect.width / 2}px`;
                particle.style.top = `${rect.top + rect.height / 2}px`;
                particle.style.backgroundColor = `hsl(${Math.random() * 30}, 100%, 60%)`;
                
                document.body.appendChild(particle);
                
                const angle = Math.random() * Math.PI * 2;
                const speed = Math.random() * 4 + 3;
                const dx = Math.cos(angle) * speed;
                const dy = Math.sin(angle) * speed;
                
                let posX = parseFloat(particle.style.left);
                let posY = parseFloat(particle.style.top);
                
                const animate = () => {
                    posX += dx;
                    posY += dy;
                    particle.style.left = `${posX}px`;
                    particle.style.top = `${posY}px`;
                    particle.style.opacity = parseFloat(particle.style.opacity || 1) - 0.03;
                    
                    if (parseFloat(particle.style.opacity || 1) > 0) {
                        requestAnimationFrame(animate);
                    } else {
                        particle.remove();
                    }
                };
                
                animate();
            }
        }
        
        // === Ø¬Ø³ÙŠÙ…Ø§Øª Ø§Ù„ØªÙ„Ù…ÙŠØ­ ===
        function createHintParticles() {
            const box = document.getElementById("box");
            const rect = box.getBoundingClientRect();
            
            for (let i = 0; i < 10; i++) {
                const particle = document.createElement("div");
                particle.classList.add("particle");
                particle.style.left = `${rect.left + rect.width / 2}px`;
                particle.style.top = `${rect.top + rect.height / 2}px`;
                particle.style.backgroundColor = `hsl(${Math.random() * 60 + 200}, 100%, 60%)`;
                
                document.body.appendChild(particle);
                
                const angle = Math.random() * Math.PI * 2;
                const speed = Math.random() * 2 + 1;
                const dx = Math.cos(angle) * speed;
                const dy = Math.sin(angle) * speed;
                
                let posX = parseFloat(particle.style.left);
                let posY = parseFloat(particle.style.top);
                
                const animate = () => {
                    posX += dx;
                    posY += dy;
                    particle.style.left = `${posX}px`;
                    particle.style.top = `${posY}px`;
                    particle.style.opacity = parseFloat(particle.style.opacity || 1) - 0.02;
                    
                    if (parseFloat(particle.style.opacity || 1) > 0) {
                        requestAnimationFrame(animate);
                    } else {
                        particle.remove();
                    }
                };
                
                animate();
            }
        }
        
        // === ØªØ£Ø«ÙŠØ±Ø§Øª Ø§Ù„Ø§Ù†ØªØµØ§Ø± ===
        function createConfetti() {
            const colors = ["#00ffcc", "#0066ff", "#ff0066", "#00ff66", "#ffcc00", "#cc00ff"];
            
            for (let i = 0; i < 150; i++) {
                const confetti = document.createElement("div");
                confetti.classList.add("particle");
                
                confetti.style.left = `${Math.random() * window.innerWidth}px`;
                confetti.style.top = `${-10}px`;
                
                confetti.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
                
                if (Math.random() > 0.5) {
                    confetti.style.borderRadius = "50%";
                } else {
                    confetti.style.borderRadius = "0";
                }
                
                const size = Math.random() * 12 + 5;
                confetti.style.width = `${size}px`;
                confetti.style.height = `${size}px`;
                
                document.body.appendChild(confetti);
                
                const angle = Math.random() * Math.PI * 2;
                const speed = Math.random() * 5 + 2;
                const dx = Math.cos(angle) * speed;
                const dy = Math.sin(angle) * speed + 2;
                
                let posX = parseFloat(confetti.style.left);
                let posY = parseFloat(confetti.style.top);
                
                const animateConfetti = () => {
                    posX += dx;
                    posY += dy;
                    confetti.style.left = `${posX}px`;
                    confetti.style.top = `${posY}px`;
                    
                    confetti.style.transform = `rotate(${posX + posY}deg)`;
                    
                    if (posY < window.innerHeight) {
                        requestAnimationFrame(animateConfetti);
                    } else {
                        confetti.remove();
                    }
                };
                
                animateConfetti();
            }
        }
        
        // === ØªØ´ØºÙŠÙ„ Ø§Ù„Ø£ØµÙˆØ§Øª ===
        function playSound(type) {
            // Ø¥ØµØ¯Ø§Ø± ØµÙˆØªÙŠ Ø¨Ø³ÙŠØ· Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… Web Audio API
            try {
                const audioContext = new (window.AudioContext || window.webkitAudioContext)();
                
                if (type === "success") {
                    // ØµÙˆØª Ù†Ø¬Ø§Ø­
                    const oscillator = audioContext.createOscillator();
                    const gainNode = audioContext.createGain();
                    
                    oscillator.connect(gainNode);
                    gainNode.connect(audioContext.destination);
                    
                    oscillator.frequency.value = 800;
                    oscillator.type = 'sine';
                    
                    gainNode.gain.setValueAtTime(0.3, audioContext.currentTime);
                    gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.5);
                    
                    oscillator.start(audioContext.currentTime);
                    oscillator.stop(audioContext.currentTime + 0.5);
                    
                } else if (type === "error") {
                    // ØµÙˆØª Ø®Ø·Ø£
                    const oscillator = audioContext.createOscillator();
                    const gainNode = audioContext.createGain();
                    
                    oscillator.connect(gainNode);
                    gainNode.connect(audioContext.destination);
                    
                    oscillator.frequency.value = 300;
                    oscillator.type = 'sawtooth';
                    
                    gainNode.gain.setValueAtTime(0.3, audioContext.currentTime);
                    gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.3);
                    
                    oscillator.start(audioContext.currentTime);
                    oscillator.stop(audioContext.currentTime + 0.3);
                }
            } catch (e) {
                console.log("Audio not supported");
            }
        }
        
        // === Ø§Ù„Ø³Ù…Ø§Ø­ Ø¨Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø¨Ø§Ù„Ø²Ø± Enter ===
        document.getElementById("password").addEventListener("keypress", function(e) {
            if (e.key === "Enter") {
                checkPassword();
            }
        });
        
        document.getElementById("answer").addEventListener("keypress", function(e) {
            if (e.key === "Enter") {
                checkAnswer();
            }
        });
        
        // === Ø®Ù„ÙÙŠØ© Matrix ===
        const canvas = document.getElementById("matrix");
        const ctx = canvas.getContext("2d");
        
        let width = canvas.width = window.innerWidth;
        let height = canvas.height = window.innerHeight;
        let cols = Math.floor(width / 20);
        let ypos = Array(cols).fill(0);
        
        function matrixEffect() {
            ctx.fillStyle = "rgba(10, 10, 20, 0.05)";
            ctx.fillRect(0, 0, width, height);
            
            ctx.fillStyle = "#00ffcc";
            ctx.font = "15px monospace";
            
            for (let i = 0; i < ypos.length; i++) {
                let text = String.fromCharCode(0x30A0 + Math.random() * 96);
                ctx.fillText(text, i * 20, ypos[i] * 20);
                
                if (ypos[i] * 20 > height && Math.random() > 0.975) {
                    ypos[i] = 0;
                }
                
                ypos[i] += 0.5 + Math.random() * 0.5;
            }
            
            requestAnimationFrame(matrixEffect);
        }
        
        // === ØªÙ‡ÙŠØ¦Ø© Ø§Ù„ØµÙØ­Ø© ===
        function init() {
            // Ø¶Ø¨Ø· Ø­Ø¬Ù… Canvas
            function resizeCanvas() {
                width = canvas.width = window.innerWidth;
                height = canvas.height = window.innerHeight;
                cols = Math.floor(width / 20);
                ypos = Array(cols).fill(0);
            }
            
            window.addEventListener("resize", resizeCanvas);
            
            // ØªØ´ØºÙŠÙ„ Ø®Ù„ÙÙŠØ© Ø§Ù„Ù…ØµÙÙˆÙØ©
            matrixEffect();
            
            // Ø§Ù„ØªØ±ÙƒÙŠØ² Ø¹Ù„Ù‰ Ø­Ù‚Ù„ ÙƒÙ„Ù…Ø© Ø§Ù„Ø³Ø±
            document.getElementById("password").focus();
            
            // Ø·Ù„Ø¨ Ø§Ø³Ù… Ø§Ù„Ù„Ø§Ø¹Ø¨
            setTimeout(() => {
                const name = prompt("Ø£Ø¯Ø®Ù„ Ø§Ø³Ù…Ùƒ (ÙƒÙ‚Ø§Ø¦Ø¯ Ù„Ù„ÙØ±ÙŠÙ‚):", "Ø§Ù„Ù…Ø­Ù‚Ù‚");
                if (name && name.trim() !== "") {
                    playerName = name.trim();
                }
            }, 1000);
        }
        
        // Ø¨Ø¯Ø¡ Ø§Ù„Ù„Ø¹Ø¨Ø© Ø¹Ù†Ø¯ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø©
        window.onload = init;
    </script>
</body>
</html>
